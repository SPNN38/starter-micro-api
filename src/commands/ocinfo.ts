import TelegramBot from "node-telegram-bot-api";
import { isAdmin } from "../../api/api.js";
import { bot } from "../../bot.js";
import { cards, isMaintenance, sql, usersInDB } from "../../data/config.js";

export async function ocinfo(message: TelegramBot.Message) {
    try {
        if (!usersInDB.has(message.from?.id)) {
            await sql.query(`INSERT INTO users (name, id, bals, coins, time, isAdmin, resets, level, vip, vipcoins, cards, packs, bafs) values ('${message.from?.username}', ${message.from?.id}, 0, 0, 0, false, 0, 0, 0, 0, ARRAY[]::integer[], ARRAY[]::integer[], ARRAY[]::integer[])`);
        }
    } catch {} finally {
        usersInDB.add(message.from?.id);
    }

    if (!(await isAdmin(message.from!.id)) && isMaintenance) {
        return;
    };

    try {
        await bot.sendMessage(message.chat.id, `<b>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è üîÆ</b>
<i>–ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å /oc –∏ –æ—Ç–∫—Ä—ã—Ç—å 1 –∫–∞—Ä—Ç—É, –≤—Å–µ–≥–æ –≤ –∏–≥—Ä–µ ${cards.length} –∫–∞—Ä—Ç.
–°—Ä–µ–¥–∏ —ç—Ç–∏—Ö –∫–∞—Ä—Ç –µ—Å—Ç—å —Å–≤–æ–∏ —Ä–µ–¥–∫–æ—Å—Ç–∏ –∑–∞ –∫–æ—Ç–æ—Ä—ã–µ –¥–∞—é—Ç —Ä–∞–∑–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ë–∞–ª–ª–æ–≤ –¥–ª—è –†–µ–π—Ç–∏–Ω–≥–∞ –∏ –î—Ä–∞–≥–µ–Ω–∫–æ–∏–Ω–æ–≤, –∑–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –†–µ–¥–∫–∏–π –°—É–Ω–¥—É–∫, –≥–¥–µ –Ω–µ –ø–∞–¥–∞–µ—Ç –û–±—ã—á–Ω–∞—è –∫–∞—Ä—Ç–∞, –∞ –ø–∞–¥–∞—é—Ç —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç—ã –≤—ã—Å—à–µ–π —Å—Ç–µ–ø–µ–Ω–∏.
                        
üç™ –†–µ–¥–∫–æ—Å—Ç–∏: 
                    
–û–±—ã—á–Ω–∞—è [–®–∞–Ω—Å 90%] (—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –†–µ–¥–∫–æ–≥–æ —Å—É–Ω–¥—É–∫–∞ [–®–∞–Ω—Å 0%])
                        
–°—Ä–µ–¥–Ω—è—è: [–®–∞–Ω—Å 5%] (—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –†–µ–¥–∫–æ–≥–æ —Å—É–Ω–¥—É–∫–∞ [–®–∞–Ω—Å 80%])
                        
–ú–∞–≥–∏—á–µ—Å–∫–∞—è: [–®–∞–Ω—Å 3%] (—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –†–µ–¥–∫–æ–≥–æ —Å—É–Ω–¥—É–∫–∞ [–®–∞–Ω—Å 10%])
                        
–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è:  [–®–∞–Ω—Å 1.2%] (—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –†–µ–¥–∫–æ–≥–æ —Å—É–Ω–¥—É–∫–∞ [–®–∞–Ω—Å 5%])
                        
–ú–∏—Ñ–∏—á–µ—Å–∫–∞—è: [–®–∞–Ω—Å 0.8%] (—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –†–µ–¥–∫–æ–≥–æ —Å—É–Ω–¥—É–∫–∞ [–®–∞–Ω—Å 3%])
                          
–°–ø–µ—Ü–∞–∏–ª—å–Ω–∞—è: [–®–∞–Ω—Å 2%] (–ü–∞–¥–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å —Ä–µ–¥–∫–æ–≥–æ —Å—É–Ω—É–¥–∫–∞)
                        
–ü–µ—Ä–≤–æ—Å—Ö–æ–¥–Ω–∞—è: [–®–∞–Ω—Å 0.01%] (—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –†–µ–¥–∫–æ–≥–æ —Å—É–Ω—É–¥–∫–∞ [–®–∞–Ω—Å 0.1%])
                        
¬ª –ß—Ç–æ-–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –†–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞–ø–∏—à–∏—Ç–µ /top 
                        
¬ª –ß—Ç–æ-–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –Ω–∞–ø–∏—à–∏—Ç–µ /stats</i>`, {
        parse_mode: "HTML",
        reply_to_message_id: message.message_id,
    });
    } catch {};
};
